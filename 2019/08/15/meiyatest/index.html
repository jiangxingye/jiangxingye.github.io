<!DOCTYPE html>





<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="姜兴业非官方网站" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Kopieren',
      copy_success: 'Kopiert',
      copy_failure: 'Kopieren fehlgeschlagen'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="美亚CH服务器性能基准测试 硬件配置一览表   型号 内部名称 技术规格     刀片机 还原（配套智能网卡）-低配 高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置:2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/128G DDR4内存/1*600G 15K SAS希捷硬盘/按厂商需求配备raid（有些品牌不配raid没法识别硬盘）/至少配备2个千兆网口，1个独立MGMT带外管">
<meta name="keywords" content="美亚测试机">
<meta property="og:type" content="article">
<meta property="og:title" content="meiyatest">
<meta property="og:url" content="https://jiangxingye.github.io/2019/08/15/meiyatest/index.html">
<meta property="og:site_name" content="姜兴业非官方网站">
<meta property="og:description" content="美亚CH服务器性能基准测试 硬件配置一览表   型号 内部名称 技术规格     刀片机 还原（配套智能网卡）-低配 高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置:2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/128G DDR4内存/1*600G 15K SAS希捷硬盘/按厂商需求配备raid（有些品牌不配raid没法识别硬盘）/至少配备2个千兆网口，1个独立MGMT带外管">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://jiangxingye.github.io/.io//3f08f42e7eb2c1942eeed79dd1085cb3.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//69ac37994a381a720102b2a5db2a68e8.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//2449c646329951cf1d16064b6ee872ae.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//45931771e1bb7e555a61ea0ec9db9811.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//2e2abea932820757fd7fbede289d6046.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//a33a5ef81689966982262057c2f8145d.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//3f13831faa7287894df35d582719048f.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//807fc1f42a0e08e3398a48ad6bdd9c2c.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//bb56c0029f8f549b4cc984e036524a18.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//8e432a6721779f92712efc517a20e388.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//55693422c2f187bede43e163626a9a9d.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//8e979ce79ec9cd55ae8dd17c544bc865.png">
<meta property="og:image" content="https://jiangxingye.github.io/.io//594cc99f55d6df5ec031b64b43d0f00b.png">
<meta property="og:updated_time" content="2019-09-03T08:13:30.355Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="meiyatest">
<meta name="twitter:description" content="美亚CH服务器性能基准测试 硬件配置一览表   型号 内部名称 技术规格     刀片机 还原（配套智能网卡）-低配 高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置:2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/128G DDR4内存/1*600G 15K SAS希捷硬盘/按厂商需求配备raid（有些品牌不配raid没法识别硬盘）/至少配备2个千兆网口，1个独立MGMT带外管">
<meta name="twitter:image" content="https://jiangxingye.github.io/.io//3f08f42e7eb2c1942eeed79dd1085cb3.png">
  <link rel="canonical" href="https://jiangxingye.github.io/2019/08/15/meiyatest/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>meiyatest | 姜兴业非官方网站</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">姜兴业非官方网站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Navigationsleiste an/ausschalten">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Startseite</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archiv</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://jiangxingye.github.io/2019/08/15/meiyatest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="姜兴业">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜兴业非官方网站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">meiyatest

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              
                
              

              <time title="Erstellt: 2019-08-15 15:25:06" itemprop="dateCreated datePublished" datetime="2019-08-15T15:25:06+08:00">2019-08-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2019-09-03 16:13:30" itemprop="dateModified" datetime="2019-09-03T16:13:30+08:00">2019-09-03</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/it/" itemprop="url" rel="index"><span itemprop="name">it</span></a></span>

                
                
                  . 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/it/server/" itemprop="url" rel="index"><span itemprop="name">server</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>美亚CH服务器性能基准测试</strong></p>
<h1 id="硬件配置一览表"><a href="#硬件配置一览表" class="headerlink" title="硬件配置一览表"></a>硬件配置一览表</h1><table>
<thead>
<tr>
<th><strong>型号</strong></th>
<th><strong>内部名称</strong></th>
<th><strong>技术规格</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>刀片机</td>
<td>还原（配套智能网卡）-低配</td>
<td>高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置:2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/128G DDR4内存/1*600G 15K SAS希捷硬盘/<strong>按厂商需求配备raid（有些品牌不配raid没法识别硬盘）</strong>/至少配备2个千兆网口，1个独立MGMT带外管理口（支持远程KVM功能)/预留至少1个半高半长pcie3.0*8网卡的插槽（长167mm，高68mm,厚16mm）/支持CentOS7.3，同时支持更高版本/带导轨/机箱冗余电源/备注功耗</td>
</tr>
<tr>
<td></td>
<td>还原（配套智能网卡）-中配</td>
<td>高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置：2颗英特尔至强银牌4114 CPU（2.2GHz，10核）/256G DDR4内存/1*600G 15K SAS希捷硬盘/<strong>按厂商需求配备raid（有些品牌不配raid没法识别硬盘）</strong>/至少配备2个千兆网口，1个独立MGMT带外管理口（支持远程KVM功能/预留至少1个半高半长pcie3.0*8网卡的插槽（长167mm，高68mm,厚16mm）/支持CentOS7.3，同时支持更高版本/带导轨/机箱冗余电源/备注功耗</td>
</tr>
<tr>
<td></td>
<td>还原（配套智能网卡）-高配</td>
<td>高密多节点服务器，每U≥2节点，总高度≤4U/每节点配置为：2颗英特尔至强金牌6126 CPU（2.6GHz，12核）/512G DDR4内存/1*600G 15K SAS希捷硬盘/<strong>按厂商需求配备raid（有些品牌不配raid没法识别硬盘）</strong>/至少配备2个千兆网口，1个独立MGMT带外管理口（支持远程KVM功能）/预留至少1个半高半长pcie3.0*8网卡的插槽（长167mm，高68mm,厚16mm）/支持CentOS7.3，同时支持更高版本/带导轨/机箱冗余电源/备注功耗</td>
</tr>
<tr>
<td>索引服务器</td>
<td>索引</td>
<td>2U服务器/2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/64G DDR4/8*900G SAS 10000rpm/ Raid0、1、5、6（1G缓存带超级电容）/双万兆和双千兆网口，不配万兆光模块（要求都是Intel的网卡，并且千兆支持支持IGB驱动，igb-3.2.10、igb-3.4.7、igb-5.1.2 这些版本都可以，万兆支持IXGBE驱动）、1个独立带外管理端口（支持远程KVM）/支持CentOS7.3，同时支持更高版本/带导轨，单电源/</td>
</tr>
<tr>
<td>存储服务器</td>
<td>存储</td>
<td>2U服务器/2颗英特尔至强银牌4110 CPU（2.1GHz，8核）/128G DDR4/12*8T SATA 7200RPM/Raid0,1,5,6（1G或以上缓存，带超级电容，支持12个硬盘做1组Raid6）/每服务器双万兆和双千兆网口，不配万兆光模块（要求都是Intel的网卡，并且千兆支持支持IGB驱动，igb-3.2.10、igb-3.4.7、igb-5.1.2 这些版本都可以，万兆支持IXGBE驱动），1个独立MGMT带外管理口（支持远程KVM功能）/支持CentOS7.3及以上版本/带导轨，单电源/要求使用希捷企业级热插拔服务器硬盘/</td>
</tr>
</tbody>
</table>
<h1 id="系统安装要求"><a href="#系统安装要求" class="headerlink" title="系统安装要求"></a>系统安装要求</h1><p>出厂预安装:做好raid5、划分VD、安装Centos 7.3<br>64位、安装图形化界面等操作。（避免现场安装失败问题）</p>
<p>1、刀片机 ：<br>直接安装系统，无需做raid，按厂商需求配备raid（有些品牌不配raid没法识别硬盘）；</p>
<p>2、SOLR : raid5，划分2个VD （VD0 ：600G VD1 ：剩余空间 ，挂载为/data）</p>
<p>3、HBase : raid5，划分2个VD （VD0 ：600G VD1 ：16T ，挂载为/data<br>,其余空间不用挂载）</p>
<h1 id="测试环境准备"><a href="#测试环境准备" class="headerlink" title="测试环境准备"></a>测试环境准备</h1><p><strong>准备工作</strong></p>
<p>以下要求适用于sorl、存储的CentOS V7.3及以上版本的服务器。</p>
<p><strong>操作系统参数</strong></p>
<p>vi /etc/security/limits.conf</p>
<p>* hard nofile 1000000</p>
<p>* soft nofile 1000000</p>
<p>* hard nproc 409600</p>
<p>* soft nproc 409600</p>
<p>vi /etc/security/limits.d/20-nproc.conf</p>
<p>* soft nproc 409600</p>
<p>echo 0 > /proc/sys/vm/swappiness;</p>
<p>echo vm.swappiness=0 >> /etc/sysctl.conf</p>
<p>设置linux内核参数：</p>
<p>vi /etc/sysctl.conf</p>
<p>net.core.somaxconn = 8192</p>
<p>net.ipv4.tcp_max_syn_backlog = 8192</p>
<p>net.ipv4.tcp_synack_retries = 2</p>
<p>net.ipv4.tcp_syn_retries = 2</p>
<p>net.ipv4.tcp_timestamps = 0</p>
<p>net.ipv4.tcp_window_scaling = 1</p>
<p>net.core.rmem_max = 16777216</p>
<p>net.core.wmem_max = 16777216</p>
<p>net.ipv4.tcp_rmem = 4096 87380 16777216</p>
<p>net.ipv4.tcp_wmem = 4096 87380 16777216</p>
<p>kernel.pid_max = 200000</p>
<p>vm.max_map_count = 400000</p>
<p>并执行：</p>
<p>sysctl -p</p>
<p><strong>禁用SELINUX { 或 /etc/sysconfig/selinux disabled }</strong></p>
<p>vi /etc/selinux/config</p>
<p>SELINUX=disabled</p>
<p>并执行：</p>
<p>setenforce 0</p>
<p><strong>禁用iptables</strong></p>
<p>systemctl stop firewalld #关闭防火墙</p>
<p>systemctl disable firewalld #禁止开机启动</p>
<p><strong>HBase: gcc-c++安装</strong></p>
<p>CentOS7.3 gcc-c++ 将依赖的包放在ee文件夹上传到/opt目录或者从系统盘中安装</p>
<p>cd /opt/ee</p>
<p>执行如下操作：</p>
<p>rpm -ivh glibc-common-2.17-157.el7.x86_64.rpm</p>
<p>rpm -ivh kernel-headers-3.10.0-514.el7.x86_64.rpm</p>
<p>rpm -ivh libgcc-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh libgcc-4.8.5-11.el7.i686.rpm</p>
<p>rpm -ivh glibc-2.17-157.el7.x86_64.rpm</p>
<p>rpm -ivh mpfr-3.1.1-4.el7.x86_64.rpm</p>
<p>rpm -ivh libgomp-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh nscd-2.17-157.el7.x86_64.rpm</p>
<p>rpm -ivh glibc-headers-2.17-157.el7.x86_64.rpm</p>
<p>rpm -ivh glibc-devel-2.17-157.el7.x86_64.rpm</p>
<p>rpm -ivh libstdc++-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh libstdc++-devel-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh libmpc-1.0.1-3.el7.x86_64.rpm</p>
<p>rpm -ivh cpp-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh gcc-4.8.5-11.el7.x86_64.rpm</p>
<p>rpm -ivh gcc-c++-4.8.5-11.el7.x86_64.rpm</p>
<p>[\@more\@] gcc -v （查看是否安装成功）</p>
<p>[root\@localhost ee]# gcc -v</p>
<p>Using built-in specs.</p>
<p>COLLECT_GCC=gcc</p>
<p>COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/4.8.5/lto-wrapper</p>
<p>Target: x86_64-redhat-linux</p>
<p>Configured with: ../configure –prefix=/usr –mandir=/usr/share/man<br>–infodir=/usr/share/info –with-bugurl=<a href="http://bugzilla.redhat.com/bugzilla" target="_blank" rel="noopener">http://bugzilla.redhat.com/bugzilla</a><br>–enable-bootstrap –enable-shared –enable-threads=posix<br>–enable-checking=release –with-system-zlib –enable-__cxa_atexit<br>–disable-libunwind-exceptions –enable-gnu-unique-object<br>–enable-linker-build-id –with-linker-hash-style=gnu<br>–enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto –enable-plugin<br>–enable-initfini-array –disable-libgcj<br>–with-isl=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/isl-install<br>–with-cloog=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/cloog-install<br>–enable-gnu-indirect-function –with-tune=generic –with-arch_32=x86-64<br>–build=x86_64-redhat-linux</p>
<p>Thread model: posix</p>
<p>gcc version 4.8.5 20150623 (Red Hat 4.8.5-11) (GCC) (说明安装成功)</p>
<p><strong>JDK安装</strong></p>
<p>cd /usr/local</p>
<p>将jdk1.7.0_25.tar.gz放在/usr/local解压.</p>
<p>ln -s /usr/local/jdk1.7.0_25/ /usr/local/java7</p>
<p>vi /etc/profile</p>
<p>添加：</p>
<p>export JAVA_HOME=/usr/local/java7</p>
<p>export PATH=\$JAVA_HOME/bin:\$PATH</p>
<p>export HADOOP_HOME=/usr/local/hadoop</p>
<p>export PATH=\$HADOOP_HOME/bin:\$PATH</p>
<p>export HBASE_HOME=/usr/local/hbase</p>
<p>export PATH=\$HBASE_HOME/bin:\$PATH</p>
<p>并执行：</p>
<p>source /etc/profile</p>
<h1 id="FIO测试"><a href="#FIO测试" class="headerlink" title="FIO测试"></a>FIO测试</h1><h2 id="1、fio安装"><a href="#1、fio安装" class="headerlink" title="1、fio安装"></a>1、fio安装</h2><p>fio-2.1.10.tar.gz解压至/usr/local/</p>
<p>cd /usr/local</p>
<p>tar zxvf fio-2.1.10.tar.gz</p>
<p>cd fio-2.0.7<br>make<br>make install</p>
<p>fio测试</p>
<h2 id="2、还原机FIO"><a href="#2、还原机FIO" class="headerlink" title="2、还原机FIO"></a>2、还原机FIO</h2><p>随机写50MB ，bs 2k</p>
<p>fio -filename=/dev/sda -direct=1 -iodepth 8 -thread -rw=randwrite<br>-ioengine=psync -bs=2k -size=50MB -numjobs=30 -runtime=300 -group_reporting<br>-name=mytest</p>
<p>随机写1G ，bs 4k</p>
<p>fio -filename=/dev/sda -direct=1 -iodepth 8 -thread -rw=randwrite<br>-ioengine=psync -bs=4k -size=1G -numjobs=30 -runtime=300 -group_reporting<br>-name=mytest</p>
<p>顺序读50M ，bs 2k</p>
<p>fio -filename=/dev/sda -direct=1 -iodepth 8 -thread -rw=read -ioengine=psync<br>-bs=2k -size=50MB -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>顺序读1G ，bs 4k</p>
<p>fio -filename=/dev/sda -direct=1 -iodepth 8 -thread -rw=read -ioengine=psync<br>-bs=4k -size=1G -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<h2 id="3、索引FIO"><a href="#3、索引FIO" class="headerlink" title="3、索引FIO"></a>3、索引FIO</h2><p>顺序写500MB ，bs 512k</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=write -ioengine=psync<br>-bs=512K -size=500MB -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>顺序写1G，bs 1MB</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=write -ioengine=psync<br>-bs=1MB -size=1G -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>随机读500MB ，bs 512k</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=randread -ioengine=psync<br>-bs=512K -size=500MB -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>随机读1G ，bs 1MB</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=randread -ioengine=psync<br>-bs=1MB -size=1G -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<h2 id="4、存储FIO"><a href="#4、存储FIO" class="headerlink" title="4、存储FIO"></a>4、存储FIO</h2><p>顺序写500MB ，bs 512k</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=write -ioengine=psync<br>-bs=512K -size=500MB -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>顺序写1G，bs 1MB</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=write -ioengine=psync<br>-bs=1MB -size=1G -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>随机读500MB ，bs 512k</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=randread -ioengine=psync<br>-bs=512K -size=500MB -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<p>随机读1G ，bs 1MB</p>
<p>fio -filename=/dev/sdb -direct=1 -iodepth 8 -thread -rw=randread -ioengine=psync<br>-bs=1MB -size=1G -numjobs=30 -runtime=300 -group_reporting -name=mytest</p>
<h1 id="索引基准测试"><a href="#索引基准测试" class="headerlink" title="索引基准测试"></a>索引基准测试</h1><h2 id="SOLR安装"><a href="#SOLR安装" class="headerlink" title="SOLR安装"></a>SOLR安装</h2><p>solrs.tar 解压至/usr/local/</p>
<p>tar xvf solrs.tar</p>
<p>solrs_data.tar 解压至/data</p>
<p>tar xvf solrs_data.tar</p>
<h2 id="将数据解压至-data"><a href="#将数据解压至-data" class="headerlink" title="将数据解压至/data"></a>将数据解压至/data</h2><p>scp ip:/home/benchmark_solr.tar /data</p>
<p>cd /data</p>
<p>tar xvf benchmark_solr.tar</p>
<h2 id="solr基准测试"><a href="#solr基准测试" class="headerlink" title="solr基准测试"></a>solr基准测试</h2><p>启动solr</p>
<p>killall java;</p>
<p>/data/benchmark/solrs/yk/bin/startup.sh</p>
<p>清空系统缓存</p>
<p>echo 3 > /proc/sys/vm/drop_caches</p>
<p>验证<a href="http://**ip**:8900/solr/yk/select?q=\*%3A\*&amp;wt=json&amp;indent=true确保访问正常，返回如下结果" target="_blank" rel="noopener">http://**ip**:8900/solr/yk/select?q=\*%3A\*&amp;wt=json&amp;indent=true确保访问正常，返回如下结果</a></p>
<p><img src="/.io//3f08f42e7eb2c1942eeed79dd1085cb3.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-22344.png"></p>
<p>登录任意一台服务器（如：172.16.20.159，与solr服务器同一网段），安装perl环境（perl为系统盘对应的版本）</p>
<p>将benchmark.tar.gz文件解压到/opt目录后执行如下操作：</p>
<p>cd /opt/benchmark/solr/</p>
<p>修改benchmark.perl一些参数配置：</p>
<p>forkCount:并发数 测试并发数为：100</p>
<p>queryCount:查询次数 测试并发数为：1000</p>
<p>urlHost：目标主机ip 根据实际SOLR服务器的ip配置</p>
<p><img src="/.io//69ac37994a381a720102b2a5db2a68e8.png" alt></p>
<p>执行benchmark文件：perl benchmark.perl，运行结果：</p>
<p><img src="/.io//2449c646329951cf1d16064b6ee872ae.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-22442.png"></p>
<p>Req/s:(每秒请求数)</p>
<p>Avg:平均耗时</p>
<p>Median:中间耗时</p>
<p>95th:95%的查询耗在2.604范围</p>
<p>99th:99%的查询耗时在5.498范围</p>
<p>Max：最大耗时</p>
<h1 id="存储基准测试"><a href="#存储基准测试" class="headerlink" title="存储基准测试"></a>存储基准测试</h1><h2 id="1、主机名配置"><a href="#1、主机名配置" class="headerlink" title="1、主机名配置"></a>1、主机名配置</h2><p>vi /etc/sysconfig/network</p>
<p><img src="/.io//45931771e1bb7e555a61ea0ec9db9811.png" alt></p>
<p>并执行hostname HBase-01</p>
<h2 id="2、主机名查询静态表配置"><a href="#2、主机名查询静态表配置" class="headerlink" title="2、主机名查询静态表配置"></a>2、主机名查询静态表配置</h2><p><img src="/.io//2e2abea932820757fd7fbede289d6046.png" alt></p>
<h2 id="3、snappy安装"><a href="#3、snappy安装" class="headerlink" title="3、snappy安装"></a>3、snappy安装</h2><p>snappy-1.1.2.tar.gz解压至/opt/下</p>
<p>cd /opt;</p>
<p>tar zxvf snappy-1.1.2.tar.gz</p>
<p>cd /snappy-1.1.2</p>
<p>./configure</p>
<p>make</p>
<blockquote>
<p>  make install</p>
</blockquote>
<h2 id="4、ssh无密码登陆"><a href="#4、ssh无密码登陆" class="headerlink" title="4、ssh无密码登陆"></a>4、ssh无密码登陆</h2><p>ssh-keygen -t rsa （回车到底）</p>
<blockquote>
<p>  cat /root/.ssh/id_rsa.pub >> /root/.ssh/authorized_keys</p>
</blockquote>
<h2 id="5、hadoop安装"><a href="#5、hadoop安装" class="headerlink" title="5、hadoop安装"></a>5、hadoop安装</h2><blockquote>
<p>  解压hadoop.tar至/usr/local/</p>
</blockquote>
<p>tar xvf hadoop.tar</p>
<p>ln -s /usr/local/hadoop-1.0.3/ /usr/local/hadoop</p>
<blockquote>
<p>  ln -s /usr/local/hbase-0.94.1/ /usr/local/hbase</p>
</blockquote>
<h2 id="6、hadoop启动"><a href="#6、hadoop启动" class="headerlink" title="6、hadoop启动"></a>6、hadoop启动</h2><p>killall -s 9 java</p>
<p>rm -rf /data/hadoop/</p>
<p>hadoop namenode -format</p>
<p>start-all.sh</p>
<h2 id="7、hadoop验证"><a href="#7、hadoop验证" class="headerlink" title="7、hadoop验证"></a>7、hadoop验证</h2><blockquote>
<p>  查看<a href="http://172.16.20.232:50070/dfshealth.jsp页面，确保访问正常，同时" target="_blank" rel="noopener">http://172.16.20.232:50070/dfshealth.jsp页面，确保访问正常，同时</a> Dead<br>  Nodes为0</p>
<p>  执行jps命令,确保有以下的进程</p>
</blockquote>
<p><img src="/.io//a33a5ef81689966982262057c2f8145d.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-24620.png"></p>
<h2 id="9、HBase基准测试"><a href="#9、HBase基准测试" class="headerlink" title="9、HBase基准测试"></a>9、HBase基准测试</h2><p>测试工具（yscb安装）</p>
<p>mkdir -p /opt/benchmark/hbase/;</p>
<p>解压yscb至/opt/benchmark/hbase/</p>
<p>cd /opt/benchmark/hbase/</p>
<p>tar zxvf ycsb-0.1.4.tar.gz</p>
<h2 id="10、HBase启动"><a href="#10、HBase启动" class="headerlink" title="10、HBase启动"></a>10、HBase启动</h2><p>清空系统缓存:</p>
<p>echo 3 > /proc/sys/vm/drop_caches</p>
<p>killall -s 9 java</p>
<p>rm -rf /data/hadoop/</p>
<p>hadoop namenode -format</p>
<p>start-dfs.sh</p>
<p>start-hbase.sh</p>
<h2 id="11、HBase验证"><a href="#11、HBase验证" class="headerlink" title="11、HBase验证"></a>11、HBase验证</h2><blockquote>
<p>  查看<a href="http://172.16.20.232:60010/master-status页面，确保访问正常，同时没有Dead" target="_blank" rel="noopener">http://172.16.20.232:60010/master-status页面，确保访问正常，同时没有Dead</a><br>  Region Servers</p>
<p>  执行jps命令,确保有以下的进程：</p>
</blockquote>
<p><img src="/.io//3f13831faa7287894df35d582719048f.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-26658.png"></p>
<h2 id="12、HBase基准测试"><a href="#12、HBase基准测试" class="headerlink" title="12、HBase基准测试"></a>12、HBase基准测试</h2><p>创建hbase表</p>
<p>echo “create ‘usertable’,’f1’,’f2’,’f3’”|hbase shell</p>
<p>查看表是否已经创建</p>
<p>echo list|hbase shell</p>
<p><img src="/.io//807fc1f42a0e08e3398a48ad6bdd9c2c.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-27334.png"></p>
<p>清空系统缓存:</p>
<p>echo 3 > /proc/sys/vm/drop_caches</p>
<p>cd /opt/benchmark/hbase/ycsb-0.1.4/bin;</p>
<p>执行插入测试，创建100个线程,插入100w条记录：</p>
<blockquote>
<p>  ./ycsb load hbase -P ../workloads/workloada -p threads=100 -p<br>  columnfamily=f1 -p recordcount=1000000 -s > load.dat</p>
</blockquote>
<p>测试结果存取在load.dat中,查看load.dat有如下结果</p>
<p>grep -v -E ‘UPDATE|CLEANUP’ load.dat|more</p>
<p><img src="/.io//bb56c0029f8f549b4cc984e036524a18.png" alt="C:\\Users\\zhujm\\AppData\\Local\\Temp\\ksohtml\\wps_clip_image-27170.png"></p>
<p>Runtime:执行时间(ms)</p>
<p>Throughput(ops/sec):吞吐量(每秒操作次数)</p>
<p>Operations：操作总数</p>
<p>AverageLatency：平均耗时(us)</p>
<p>MinLatency:最小耗时(us)</p>
<p>MaxLatency:最大耗时(us)</p>
<p>95thPercentileLatency(ms):95%的执行时间范围</p>
<p>99thPercentileLatency(ms):99%的执行时间范围</p>
<blockquote>
<p>  执行事务操作(95%的读操作 5%的写操作)</p>
<p>  创建100个线程,操作100w次</p>
<p>  ./ycsb run hbase -P ../workloads/workloadb -threads 100 -p<br>  measurementtype=timeseries -p columnfamily=f1 -p operationcount=1000000 -p<br>  timeseries.granularity=2000 > transactions.dat</p>
<p>  测试结果存取在transactions.dat中</p>
<p>  查看更新操作测试结果</p>
<p>  grep UPDATE transactions.dat</p>
<p>  查看读取操作测试结果</p>
<p>  grep READ transactions.dat</p>
</blockquote>
<p><img src="/.io//8e432a6721779f92712efc517a20e388.png" alt></p>
<h1 id="NMON监控"><a href="#NMON监控" class="headerlink" title="NMON监控"></a>NMON监控</h1><p>在做SOLR或HBase基准测试时，使用nmon监控服务器的CPU、内存、磁盘资源使用情况</p>
<h2 id="1、安装nmon"><a href="#1、安装nmon" class="headerlink" title="1、安装nmon"></a>1、安装nmon</h2><blockquote>
<p>  解压nmon至/usr/local/</p>
<p>  cd /usr/local</p>
<p>  tar zxvf nmon.tar.gz</p>
</blockquote>
<h2 id="2、修改nmon参数"><a href="#2、修改nmon参数" class="headerlink" title="2、修改nmon参数"></a>2、修改nmon参数</h2><blockquote>
<p>  cd nmon</p>
<p>  vi nmon_start.sh</p>
<p>  修改频率为10秒一次，监控5000次：</p>
</blockquote>
<p><img src="/.io//55693422c2f187bede43e163626a9a9d.png" alt></p>
<h2 id="3、运行nmon"><a href="#3、运行nmon" class="headerlink" title="3、运行nmon"></a>3、运行nmon</h2><blockquote>
<p>  做基准测试同时，运行nmon，监控测试时的硬件资源使用情况</p>
<p>  ./nmon_start.sh</p>
<p>  同一目录下会生成nmon文件</p>
</blockquote>
<p><img src="/.io//8e979ce79ec9cd55ae8dd17c544bc865.png" alt></p>
<h2 id="4、关掉nmon"><a href="#4、关掉nmon" class="headerlink" title="4、关掉nmon"></a>4、关掉nmon</h2><blockquote>
<p>  基准测试结束时，停掉nmon</p>
<p>  Killall nmon</p>
</blockquote>
<h2 id="5、生成图形化结果"><a href="#5、生成图形化结果" class="headerlink" title="5、生成图形化结果"></a>5、生成图形化结果</h2><blockquote>
<p>  打开nmon analyser v34a.xls，点击Analyse nmon data<br>  按键，加载nmon文件，生成图形化结果：</p>
</blockquote>
<p><img src="/.io//594cc99f55d6df5ec031b64b43d0f00b.png" alt></p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/美亚测试机/" rel="tag"># 美亚测试机</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/08/12/苏联解体的启示/" rel="next" title="苏联解体的启示">
                  <i class="fa fa-chevron-left"></i> 苏联解体的启示
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/08/16/关闭服务器CPU节能模式/" rel="prev" title="关闭服务器CPU节能模式">
                  关闭服务器CPU节能模式 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Inhaltsverzeichnis
        </li>
        <li class="sidebar-nav-overview">
          Übersicht
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#硬件配置一览表"><span class="nav-number">1.</span> <span class="nav-text">硬件配置一览表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#系统安装要求"><span class="nav-number">2.</span> <span class="nav-text">系统安装要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试环境准备"><span class="nav-number">3.</span> <span class="nav-text">测试环境准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FIO测试"><span class="nav-number">4.</span> <span class="nav-text">FIO测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、fio安装"><span class="nav-number">4.1.</span> <span class="nav-text">1、fio安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、还原机FIO"><span class="nav-number">4.2.</span> <span class="nav-text">2、还原机FIO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、索引FIO"><span class="nav-number">4.3.</span> <span class="nav-text">3、索引FIO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、存储FIO"><span class="nav-number">4.4.</span> <span class="nav-text">4、存储FIO</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#索引基准测试"><span class="nav-number">5.</span> <span class="nav-text">索引基准测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SOLR安装"><span class="nav-number">5.1.</span> <span class="nav-text">SOLR安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将数据解压至-data"><span class="nav-number">5.2.</span> <span class="nav-text">将数据解压至/data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#solr基准测试"><span class="nav-number">5.3.</span> <span class="nav-text">solr基准测试</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#存储基准测试"><span class="nav-number">6.</span> <span class="nav-text">存储基准测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、主机名配置"><span class="nav-number">6.1.</span> <span class="nav-text">1、主机名配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、主机名查询静态表配置"><span class="nav-number">6.2.</span> <span class="nav-text">2、主机名查询静态表配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、snappy安装"><span class="nav-number">6.3.</span> <span class="nav-text">3、snappy安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、ssh无密码登陆"><span class="nav-number">6.4.</span> <span class="nav-text">4、ssh无密码登陆</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、hadoop安装"><span class="nav-number">6.5.</span> <span class="nav-text">5、hadoop安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、hadoop启动"><span class="nav-number">6.6.</span> <span class="nav-text">6、hadoop启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、hadoop验证"><span class="nav-number">6.7.</span> <span class="nav-text">7、hadoop验证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9、HBase基准测试"><span class="nav-number">6.8.</span> <span class="nav-text">9、HBase基准测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10、HBase启动"><span class="nav-number">6.9.</span> <span class="nav-text">10、HBase启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11、HBase验证"><span class="nav-number">6.10.</span> <span class="nav-text">11、HBase验证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12、HBase基准测试"><span class="nav-number">6.11.</span> <span class="nav-text">12、HBase基准测试</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NMON监控"><span class="nav-number">7.</span> <span class="nav-text">NMON监控</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、安装nmon"><span class="nav-number">7.1.</span> <span class="nav-text">1、安装nmon</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、修改nmon参数"><span class="nav-number">7.2.</span> <span class="nav-text">2、修改nmon参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、运行nmon"><span class="nav-number">7.3.</span> <span class="nav-text">3、运行nmon</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、关掉nmon"><span class="nav-number">7.4.</span> <span class="nav-text">4、关掉nmon</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、生成图形化结果"><span class="nav-number">7.5.</span> <span class="nav-text">5、生成图形化结果</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">姜兴业</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">113</span>
          <span class="site-state-item-name">Artikel</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">Kategorien</span>
        
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">schlagwörter</span>
        
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">姜兴业</span>
</div>
  <div class="powered-by">Erstellt mit  <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Design – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  

</body>
</html>
